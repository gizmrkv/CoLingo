exp_name: "sample_exp"
n_iterations: 30000
seed: 3
device: "cuda"

concept_config: &concept_config
  n_attributes: 2
  n_values: 50

channel_config: &channel_config
  type: "ecsem"
  <<: *concept_config
  vocab_size: 50
  max_len: 3

dataloader_config: &dataloader_config
  type: "builtin"
  dataset: "dataset1_train"
  batch_size: 8192
  shuffle: true

datasets:
  dataset1:
    type: "concept"
    <<: *concept_config
    split:
      train: 8
      val: 2

agents:
  agent1:
    model:
      type: "internal"
      <<: *channel_config
      internal_size: 256
      embed_size: 256
      hidden_size: 256
      rnn_type: "gru"
      n_layers: 2
    optimizer:
      type: "adam"
      lr: 0.001
  agent2:
    model:
      type: "internal"
      <<: *channel_config
      internal_size: 256
      embed_size: 256
      hidden_size: 256
      rnn_type: "gru"
      n_layers: 2
    optimizer:
      type: "adam"
      lr: 0.001
tasks:
  signaling1:
    type: "signaling"
    dataloader:
      <<: *dataloader_config
      dataset: "dataset1_train"
    network:
      type: "custom"
      edges:
        - ["agent1", "agent2"]
    sender_loss:
      type: "reinforce"
      entropy_weight: 0.5
      baseline:
        type: "batch_mean"
      length_baseline:
        type: "batch_mean"
    receiver_loss:
      type: "concept"
      <<: *concept_config
    max_batches: 1

  identity1:
    type: "identity"
    dataloader:
      <<: *dataloader_config
    network:
      type: "custom"
      nodes:
        - "agent1"
        - "agent2"
    loss:
      type: "concept"
      <<: *concept_config
    max_batches: 1
